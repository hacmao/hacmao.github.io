---
layout : post 
title : BKSEC 2019  
--- 

# Mở đầu  
Đây là kì thi chọn đội tuyển chuẩn bị cho SVATTT 2019 sắp diễn ra.Trong kì thi mình feed quá, cảm thấy trình pwn còn khá cùi cần rèn luyện thêm.  😥😥😥 Mình có hỏi hint anh **chung96vn** để làm nốt mấy bài còn lại và tổng hợp lại. Nói chung là cũng học được nhiều và cảm giác có động lực try hard hơn cho kì thi sắp tới. 😁😁😁 Nếu không muốn bị tạch lần nữa.   

# Play Around  

Đây là bài pwn đầu tiên. Một dạng bài khá quen thuộc và căn bản khi bước vào học pwnable.  

![](/Pwnable/BKSEC2019/playaround/hinh1.PNG)  

Chúng ta có lỗi tràn, stack thì không có canary nên có thể tràn về địa chỉ trở về hàm ```vuln``` .   
Công việc đầu tiên là leak được libc. Chúng ta có thể ghi đè lên địa chỉ trở về địa chỉ plt của hàm printf và pass cho nó arguments là got của hàm ```printf```. Nó sẽ in ra địa chỉ của ```printf``` trong libc. Từ đó tính toán được địa chỉ của libc. Đồng thời cần trở lại hàm ```main``` 1 lần nữa.   
Cụ thể payload sẽ có dạng : 
```python 
payload = "a" * (0x80 + 8) + ret + pop_rdi + p64(0x601018) + p64(bin.sym['printf']) + ret + p64(bin.sym['vuln'])
``` 
Trong kì thi không hiểu vì lí do magic gì mà thay địa chỉ của ```got.printf``` vào lại không in được. Bỏ vào debug rõ ràng nó có gọi hàm printf rồi 😱😱😱 Test thử bằng các địa chỉ khác thì vẫn in ra được. Thế là mình thử bằng địa chỉ ```got.setbuf``` thì lại được. Loay hoay chỗ này cũng tốn kha khá thời gian .  
Công việc còn lại chỉ là gọi hàm ```system``` thôi.  


