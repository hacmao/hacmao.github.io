from z3 import * 
var = [BitVec("x%s" % i, 32) for i in range(16)] 

v17 = [0x21,0x40,0x23,0x73,0x62,0x6A,0x68,0x64,0x6E,0x35,0x7A,0x36,0x73,0x66,0x35,0x67,0x71,0x63,0x37,0x6B,0x63,0x64,0x35,0x6D,0x63,0x6B,0x37,0x6C,0x64,0x3D,0x26,0x36]
v15 = [0] * 32 
v16 = [0] * 32 
v18 = [0] * 4 
v19 = [0] * 4
v20 = [0] * 4
v21 = [0] * 4
v22 = [0] * 4
v23 = [0] * 4
v24 = [0] * 4
v25 = [0] * 4
v26 = [0] * 4
v27 = [0] * 4
v28 = [0] * 4
v29 = [0] * 4
v30 = [0] * 4
v31 = [0] * 4
v32 = [0] * 4

j = 0 
for i in range(16) : 
    v15[j] = 8 * var[i] 
    v15[j + 1] = 7 * var[i] 
    j += 2 

s = Solver() 
for i in range(32) : 
    s.add(v15[i] <= 400) 

for i in range(32) : 
    v16[i] = v15[i] ^ v17[i]

for j in range(4):
    v32[j] = v16[j]
for j in range(4):
    v31[j] = v16[j + 4]
for j in range(4):
    v30[j] = v16[j + 8]
for j in range(4):
    v29[j] = v16[j + 12]
for j in range(4):
    v28[j] = v16[j + 16]
for j in range(4):
    v27[j] = v16[j + 20]
for j in range(4):  
    v26[j] = v16[j + 24]
for j in range(4):
    v25[j] = v16[j + 28] 

dword_41F038 = [0x9b, 0xcf, 0x1db, 0x1b9]
for j in range(4) : 
    v24[j] = v31[j] ^ v32[j] 
    s.add(v24[j] == dword_41F038[j]) 
dword_41F048 = [0xf9, 0x174, 0x27f, 0x1a7]
for j in range(4) : 
    v23[j] = v29[j] + v30[j]
    s.add(dword_41F048[j] == v23[j])

dword_41F058 = [0xce, 0xb1, 0xa, 0x1b]
for j in range(4) : 
    v22[j] = v28[j] - v27[j]
    s.add( dword_41F058[j] == v22[j] )

dword_41F068 = [0xbf, 0x9b, 0x1f1, 0x7e]
for j in range(4) : 
    v21[j] = v25[j] ^ v26[j]
    s.add( dword_41F068[j] == v21[j] )

dword_41F078 = [0x37, 0x5d, 0x11d, 0x14b]
for j in range(4) : 
    v20[j] = v25[j] ^ v31[j] ^ v32[j]
    s.add(dword_41F078[j] == v20[j] )

dword_41F088 = [0x104, 0x1b3, 0x3a4, 0x22a]
for j in range(4) : 
    v19[j] = v27[j] + v29[j] + v30[j]
    s.add( dword_41F088[j] == v19[j] )

dword_41F098 = [0xad, 0xb7, 0x99, 0x9e]
for j in range(4) : 
    v18[j] = v30[j] ^ v31[j] ^ v32[j]
    s.add( dword_41F098[j] == v18[j] )
print s.check()
m = s.model()
m_ = [0] * 16
for i in range(16) : 
    m_[i] = int(str(m[var[i]])) % 256  


dword_41F0A8 = [0xC9, 0x00, 0x00, 0x00, 0xE1, 0x00, 0x00, 0x00, 0x21, 0x01, 
    0x00, 0x00, 0x69, 0x01, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 
    0x0D, 0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x7F, 0x00, 
    0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 
    0x57, 0x01, 0x00, 0x00, 0x16, 0x01, 0x00, 0x00, 0xB9, 0x00, 
    0x00, 0x00, 0xB8, 0x00, 0x00, 0x00, 0x5D, 0x01, 0x00, 0x00, 
    0x86, 0x00, 0x00, 0x00, 0x8C, 0x00, 0x00, 0x00, 0xDF, 0x00, 
    0x00, 0x00, 0x61, 0x01, 0x00, 0x00, 0xB3, 0x00, 0x00, 0x00, 
    0xF8, 0xFF, 0xFF, 0xFF, 0xEF, 0xFF, 0xFF, 0xFF, 0x67, 0x01, 
    0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 
    0xF6, 0xFF, 0xFF, 0xFF, 0x19, 0x01, 0x00, 0x00, 0x79, 0x00, 
    0x00, 0x00, 0x84, 0x00, 0x00, 0x00, 0x82, 0x00, 0x00, 0x00, 
    0x66, 0x00, 0x00, 0x00, 0x9A, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 ] 
flag = "" 
j = 0 
for i in range(16) : 
    v15[j] = 8 * m_[i] 
    v15[j + 1] = 7 * m_[i] 
    j += 2 

for i in range(32) :  
    flag += chr((v15[i] ^ (i + dword_41F0A8[4 * i])) % 256)
print "inctf{" + flag[6:]

    
