from hashlib import md5
from binascii import hexlify 
string = ['VolgaCTF{nKpV/dmkBeQ0n9Mz0g9eGQ==}','VolgaCTF{KtetaQ4YT8PhTL3O4vsfDg==}']
g = 88125476599184486094790650278890368754888757655708027167453919435240304366395317529470831972495061725782138055221217302201589783769854366885231779596493602609634987052252863192229681106120745605931395095346012008056087730365567429009621913663891364224332141824100071928803984724198563312854816667719924760795
q = 1118817215266473099401489299835945027713635248219
p = 89884656743115795425395461605176038709311877189759878663122975144592708970495081723016152663257074178905267744494172937616748015651504839967430700901664125135185879852143653824715409554960402343311756382635207838848036159350785779959423221882215217326708017212309285537596191495074550701770862125817284985959
a = 3437776292996777467976657547577967657547
b = 828669865469592426262363475477574643634
key = [(1030409245884476193717141088285092765299686864672, 830067187231135666416948244755306407163838542785),(403903893160663712713225718481237860747338118174, 803753330562964683180744246754284061126230157465),(573204611556272128788136170196175308321188191436, 91103585122319085944642441222968347176761155259),(988208923601321592314278832250352152086708201148, 535902494423594375360085340272213659149931817732),
    (398664332680411743333343859695363011153860369916, 392831307484494740050270232580899453387203218646),
    (1069308776596602518230279648695605679674084062212, 1092197517441497735860968374670599451237193808469),
    (299126738734367538949359921058714964192219834697, 1033663138335940105270395993670462206279669465530),
    (45947153576235029841784762518202071246619636555, 160232137675713914067049553022084774145041067326),
    (158481243947457932495342738131507924205209157088, 260728631055453998945003114392349125641429319965),
    (117030185689896730023482874167356847173848413476, 645757721193000290408806214518814010431656731046)]

r = [0] * 10 
s = [0] * 10 
for i in range(10) : 
    r[i] = key[i][0]
    s[i] = key[i][1] 
A = Matrix(GF(q),3,3) 
A[0,0] = s[0] 
A[0,1] = 0
A[0,2] = -r[0] 
A[1,0] = 0 
A[1,1] = s[1]
A[1,2] = -r[1]
A[2,0] = -a
A[2,1] = 1
A[2,2] = 0 

Y = vector([int(md5(string[0]).hexdigest(),16),int(md5(string[1]).hexdigest(),16),b])
print(A.solve_right(Y))
